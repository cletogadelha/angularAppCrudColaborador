"use strict";var app=angular.module("angularSpringApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","flow","ngSanitize","ui.select","uiGmapgoogle-maps","base64","angular-loading-bar"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/list",{templateUrl:"views/collab.list.html",controller:"MainCtrl"}).when("/collab",{templateUrl:"views/collab.form.html",controller:"CollabCtrl"}).when("/collab/:idCollab",{templateUrl:"views/collab.view.html",controller:"CollabCtrlView"}).when("/editCollab/:idCollab",{templateUrl:"views/collab.form.html",controller:"CollabCtrl"}).otherwise({redirectTo:"/"})}]).factory("httpRequestInterceptor",["$cookies","$window","$q",function(a,b,c){return{request:function(b){var c=a.get("auth.access_token");return void 0!==c&&-1===b.url.indexOf("/oauth/token")&&(b.headers.Authorization="Bearer "+c),b},responseError:function(a){return 401===a.status&&(b.location.href="#/"),c.reject(a)}}}]).config(["$httpProvider",function(a){a.interceptors.push("httpRequestInterceptor")}]);app.controller("MainCtrl",["$scope","$resource","Collab",function(a,b,c){a.filterCollab="",c.query(function(b){a.collaborators=b})}]),app.controller("CollabCtrl",["$scope","$resource","Collab","Map","$routeParams","$window","$http",function(a,b,c,d,e,f,g){a.ContactIcon="",a.successMessage="",a.errorMessage="",a.place={};var h=function(){a.collaborator={id:"",name:"",workLocation:"",biography:"",profession:"",competencies:[],contactList:[],address:""}};e.idCollab?c.get({id:e.idCollab}).$promise.then(function(b){a.collaborator=b,d.init(),a.collaborator.address&&a.search()}):h(),a.availableProfessions=[{profession:"Software Developer"},{profession:"Software Engineer"},{profession:"Project Manager"}],a.availableWorkLocations=[{location:"Software Factory"},{location:"Allocated at Client A"},{location:"Allocated at Client B"}],a.setProfession=function(b){a.collaborator.profession=b.originalObject.profession},a.setWorkLocation=function(b){a.collaborator.workLocation=b.originalObject.location},a.availableCompetencies=[{description:"Java"},{description:"JavaEE"},{description:"Spring"},{description:"Angular"},{description:"MEAN"}],a.removeCollaborator=function(b){c["delete"]({id:a.collaborator.id},function(){a.successMessage="Collaborator Removed!",f.location.href="#/list"})},a.setContactClass=function(a){return"Fixed Phone"===a?"fa fa-phone fa-2x":"Mobile Phone"===a?"fa fa-mobile fa-2x":"E-Mail"===a?"fa fa-inbox fa-2x":"Facebook"===a?"fa fa-facebook fa-2x":"Linkedin"===a?"fa fa-linkedin fa-2x":"Google+"===a?"fa fa-google-plus fa-2x":void 0},a.availableContacts=[{description:"Fixed Phone"},{description:"Mobile Phone"},{description:"E-Mail"},{description:"Facebook"},{description:"Linkedin"},{description:"Google+"}],a.selectedContact=a.availableContacts[0],a.contact="",a.insertContact=function(){var b={type:a.selectedContact.description,contact:a.contact};a.collaborator.contactList.push(b),a.selectedContact=a.availableContacts[0],a.contact=""},a.removeContact=function(b){var c=a.collaborator.contactList.indexOf(b);a.collaborator.contactList.splice(c,1)},a.resetFormField=function(a){a&&a.contact.$setPristine()},a.saveCollaborator=function(){a.successMessage="",a.errorMessage="";var b=new c(a.collaborator);b.$save().then(function(b){a.successMessage="Collaborator saved!",a.insertedContacts=[],a.contact="",a.searchPlace="",h()})["catch"](function(b){a.errorMessage="Oops! Sorry for that!"});f.document.getElementById("header").scrollIntoView()},a.map={center:{latitude:52.47491894326404,longitude:-1.8684210293371217},zoom:15},a.search=function(){a.apiError=!1,d.search(a.collaborator.address).then(function(b){d.addMarker(b),a.place.name=b.name,a.place.lat=b.geometry.location.lat(),a.place.lng=b.geometry.location.lng()},function(b){a.apiError=!0,a.apiStatus=b,a.errorMessage="Oops! Error loading the map!"})},d.init()}]),app.controller("CollabCtrlView",["$scope","$resource","Collab","Map","$routeParams","$window",function(a,b,c,d,e,f){a.objFlow={},a.contactIcon="",a.successMessage="",a.errorMessage="",c.get({id:e.idCollab}).$promise.then(function(b){a.collaborator=b,a.collaborator.address&&a.search()}),a.removeCollaborator=function(b){c["delete"]({id:a.collaborator.id},function(){a.successMessage="Collaborator Removed!",f.location.href="#/list"})},a.setContactClass=function(a){return"Fixed Phone"===a?"fa fa-phone fa-2x":"Mobile Phone"===a?"fa fa-mobile fa-2x":"E-Mail"===a?"fa fa-inbox fa-2x":"Facebook"===a?"fa fa-facebook fa-2x":"Linkedin"===a?"fa fa-linkedin fa-2x":"Google+"===a?"fa fa-google-plus fa-2x":void 0},a.map={center:{latitude:52.47491894326404,longitude:-1.8684210293371217},zoom:15},a.place={},a.search=function(){a.apiError=!1,d.search(a.collaborator.address).then(function(b){d.addMarker(b),a.place.name=b.name,a.place.lat=b.geometry.location.lat(),a.place.lng=b.geometry.location.lng()},function(b){a.apiError=!0,a.apiStatus=b,a.messageErro="Oops! Error loading the map;"})},d.init()}]),app.controller("LoginCtrl",["$scope","$http","$window","$cookies","$base64",function(a,b,c,d,e){a.errorMessage="",a.login=function(){var f="username="+this.user+"&password="+this.password+"&grant_type=password&scope=read%20write&";b.post("http://localhost:8080/oauth/token",f,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+e.encode("clientapp:springSecurity")}}).then(function(a){return d.put("auth.access_token",a.data.access_token),d.put("auth.refresh_token",a.data.refresh_token),c.location.href="#/list",!1},function(b){a.errorMessage=b.data.error_description})}}]),app.factory("Collab",["$resource",function(a){return a("http://localhost:8080/rest/collaborator/:id",{id:"@idCollab"},{update:{method:"PUT"}})}]),app.service("Map",["$q",function(a){this.init=function(){var a={center:new google.maps.LatLng(-15.7990489,-47.8629576),zoom:13,disableDefaultUI:!0};null!=document.getElementById("map")&&(this.map=new google.maps.Map(document.getElementById("map"),a),this.places=new google.maps.places.PlacesService(this.map))},this.search=function(b){var c=a.defer();return this.places.textSearch({query:b},function(a,b){"OK"==b?c.resolve(a[0]):c.reject(b)}),c.promise},this.addMarker=function(a){this.marker&&this.marker.setMap(null),this.marker=new google.maps.Marker({map:this.map,position:a.geometry.location,animation:google.maps.Animation.DROP}),this.map.setCenter(a.geometry.location)}}]),app.directive("myEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.myEnter)}),b.preventDefault())})}}),angular.module("angularSpringApp").run(["$templateCache",function(a){a.put("views/collab.form.html",'<!DOCTYPE html> <html ng-controller="CollabCtrl"> <head> <meta charset="UTF-8"> <title>Cleto Gadelha | Collaborators CRUD</title> </head> <style>#map {\n        height: 300px;\n        border-radius: 5px;\n        border: 1px solid silver;\n    }</style> <h1 class="text-center">Collaborator</h1> <body flow-prevent-drop> <form name="formCollab" ng-submit="saveCollaborator()"> <div id="divMsg"> <div class="alert alert-success" ng-show="successMessage"> {{successMessage}} </div> <div class="alert alert-danger" ng-show="errorMessage"> {{errorMessage}} </div> </div> <button class="fa fa-check btn btn-primary pull-right" type="submit"> Save </button> <a style="cursor: pointer; text-decoration: none !important" class="fa fa-arrow-left fa-2x pull-left" ng-href="#/list" title="Back" type="button"></a> <br><br> <br><br> <!-- NAME --> <div class="form-group"> <input class="form-control" id="nome" placeholder="Full Name" required name="name" ng-model="collaborator.name" type="text"> </div> <!-- /NAME --> <!-- PROFESSION --> <div class="form-group"> <select class="form-control" name="profession" id="professionSelect" ng-model="collaborator.profession" required> <option value="">Select your Profession</option> <option ng-repeat="prof in availableProfessions" value="{{prof.profession}}">{{prof.profession}}</option> </select> </div> <!-- PROFESSION --> <!-- WORKLOCATION --> <div class="form-group"> <select class="form-control" name="workLocation" id="workLocationSelect" ng-model="collaborator.workLocation" required> <option value="">Select your Work Location</option> <option ng-repeat="local in availableWorkLocations" value="{{local.location}}">{{local.location}}</option> </select> </div> <!-- /WORKLOCATION --> <!-- BIOGRAPHY --> <div class="form-group"> <textarea class="form-control" ng-model="collaborator.biography" name="biography" id="biographyTextArea" required placeholder="Tell Me Something About Yourself" ng-trim="false">\n    </textarea> </div> <!-- /BIOGRAPHY--> <!-- COMPETENCIES--> <div class="form-group"> <label for="competencies">Competencies</label> <ui-select class="form-control" multiple tagging tagging-label=" - Insert a new competency" ng-model="collaborator.competencies" theme="bootstrap" title="Insert your competencies"> <ui-select-match class="ui-select-match" placeholder="Insert your competencies">{{$item.description}}</ui-select-match> <ui-select-choices class="ui-select-choices" repeat="competency in availableCompetencies | filter : $select.search"> {{competency.description}} </ui-select-choices> </ui-select> </div> <!-- /COMPETENCIES --> <!-- CONTACTS --> <div class="form-group"> <label for="contacts">Contacts</label> <div class="form-inline"> <i class="{{setContactClass(selectedContact.description)}}"></i> <select name="contact" id="contactSelect" ng-model="selectedContact" required ng-options="contact as contact.description for contact in availableContacts">> </select> <input id="contact" placeholder="Provide your contact" name="contact" ng-model="contact" type="text"> <input value="New" type="button" class="pull-right btn btn-warning" ng-click="insertContact(); resetFormField(formCollab)" ng-disabled="formCollab.contact.$pristine"> </div> <br><br> <table class="table table-striped"> <tr ng-repeat="contact in collaborator.contactList"> <td style="width:10px"> <i class="{{setContactClass(contact.type)}}"></i> </td> <td>{{ contact.type }}</td> <td>{{ contact.contact }}</td> <td> <button type="button" class="pull-right fa fa-times" ng-click="removeContact(contact)"></button> </td> </tr> </table> </div> <!-- /CONTACS --> <!-- ADDRESS --> <div class="form-group"> <div class="form-inline"> <i class="fa fa-map-marker fa-2x"></i> <input class="form-control" required style="width:97%" id="address" placeholder="Provide your Address" name="address" ng-model="collaborator.address" type="text" ng-blur="search()" my-enter="search()"> </div> <br> <!-- GOOGLE MAPS --> <div id="map"></div> </div></form> </body> </html>'),a.put("views/collab.list.html",'<!DOCTYPE html> <html ng-controller="MainCtrl"> <head> <meta charset="UTF-8"> <title>Cleto Gadelha | Collaborators CRUD </title> <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"> </head> <body class="skin-blue"> <section class="content"> <div id="divMsg"> <div class="alert alert-success" ng-show="successMessage"> {{successMessage}} </div> <div class="alert alert-danger" ng-show="errorMessage"> {{errorMessage}} </div> </div> <div class="row form-group"> <p align="right"> <h1 style="float: left">Collaborators</h1> <a style="float: right; position: relative; top: 30px" class="pull-rigth glyphicon glyphicon-plus btn btn-primary" ng-href="#/collab"> New </a> </p> <input class="form-control" ng-model="filterCollab" type="search" placeholder="Search by Name"> </div> <br> <div ng-init="countLimit = 10"> <div class="col-lg-6 col-xs-6" ng-repeat="collab in collaborators\n                                                      | filter: {name : filterCollab}\n                                                      | limitTo: countLimit as results\n                                                  "> <!-- small box --> <div class="small-box bg-aqua"> <img align="left" src="images/yeoman.c582c4d1.png"> <div class="padding: 15px"> <h2> {{collab.name}} </h2> </div> <div class="padding: 15px"> <p> {{collab.profession}} </p> </div> <div class="padding: 15px"> <p> {{collab.workLocation}} </p> </div> <a class="small-box-footer" ng-href="#/collab/{{collab.id}}"> More information <i class="fa fa-arrow-circle-right"></i> </a> </div> </div> <!-- ./col --> </div> <div class="row" ng-hide="results.length === collaborators.length || filterCollab.length > 0"> <center> <a class="btn btn-circle btn-primary" ng-click="countLimit = countLimit+10">More</a> </center> </div> </section> </body> </html>'),a.put("views/collab.view.html",'<!DOCTYPE html> <html ng-controller="CollabCtrlView"> <head> <meta charset="UTF-8"> <title>Cleto Gadelha | Collaborators CRUD </title> <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"> </head> <style>#map {\n    height: 300px;\n    border-radius: 5px;\n    border: 1px solid silver;\n  }\n\n  .img {\n    width: 130px;\n    height: 130px;\n    position: relative;\n    position: relative;\n    left: 140px;\n  }\n\n  .dentro {\n    text-align: center;\n    vertical-align: middle;\n  }</style> <h1 class="text-center">Collaborator</h1> <body> <form name="formInfoCollab"> <div id="divMsg"> <div class="alert alert-success" ng-show="successMessage"> {{successMessage}} </div> <div class="alert alert-danger" ng-show="errorMessage"> {{errorMessage}} </div> </div> <a style="cursor: pointer; text-decoration: none !important" class="fa fa-pencil fa-2x pull-right" title="Edit Collaborator" ng-href="#/editCollab/{{collaborator.id}}" type="button"></a> <a style="cursor: pointer; text-decoration: none !important" class="fa fa-trash-o fa-2x pull-right" ng-click="removeCollaborator(collaborator.id)" title="Remove Collaborator" type="button"></a> <a style="cursor: pointer; text-decoration: none !important" class="fa fa-arrow-left fa-2x pull-right" ng-href="#/list" title="Back" type="button"></a> <br> <br> <!-- NAME --> <div class="form-group"> <input class="form-control" disabled id="name" name="name" ng-model="collaborator.name" type="text"> </div> <!-- /NAME --> <!-- PROFESSION --> <div class="form-group"> <input class="form-control" disabled id="profession" name="profession" ng-model="collaborator.profession" type="text"> </div> <!-- /PROFESSION --> <!-- WORK LOCATION --> <div class="form-group"> <input class="form-control" disabled id="workLocation" name="workLocation" ng-model="collaborator.workLocation" type="text"> </div> <!-- /WORK LOCATION --> <!-- BIOGRAPHY --> <div class="form-group"> <textarea class="form-control" disabled ng-model="collaborator.biography" name="biography" id="biographyTextArea">\n      </textarea> </div> <!-- /BIOGRAPHY --> <!-- COMPETENCIES --> <div> <div> <label for="competencies">Competencies</label> </div> <span ng-repeat="competency in collaborator.competencies"> <button class="btn btn-group btn-default" disabled> {{competency.description}} </button> </span> </div> <br> <!-- /COMPETENCIES --> <!-- Contacts --> <div class="form-group"> <div> <label for="contacts">Contacts</label> <br> <span ng-repeat="contact in collaborator.contactList"> <i class="{{setContactClass(contact.type)}}"></i> <span style="padding: 10px">{{ contact.contact }}</span> <br> <br> </span> </div> </div> <!-- /CONTACT --> <!-- ADDRESS --> <div class="form-group"> <div class="form-inline"> <i class="fa fa-map-marker fa-2x"></i> <input class="form-control" disabled style="width:95%" id="address" name="address" ng-model="collaborator.address" type="text"> </div> <br> <div id="map"></div> </div> <!--/ADDRESS --> </form> </body> </html>'),a.put("views/login.html",'<!DOCTYPE html> <html class="bg-black" ng-controller="LoginCtrl"> <head> <meta charset="UTF-8"> <title>Cleto Gadelha | Collaborators CRUD</title> <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"> </head> <body class="bg-black"> <div id="divMsg"> <div class="alert alert-danger" ng-show="errorMessage"> {{errorMessage}} </div> </div> <div class="form-box" id="login-box"> <div class="header">Login</div> <form> <div class="body bg-gray"> <div class="form-group"> <input type="text" ng-model="user" name="userid" class="form-control" placeholder="Username"> </div> <div class="form-group"> <input type="password" ng-model="password" name="password" class="form-control" placeholder="Password"> </div> </div> <div class="footer"> <button class="btn bg-olive btn-block" ng-click="login()">Login</button> </div> </form> </div> </body> </html>')}]);